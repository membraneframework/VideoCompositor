"use strict";(self.webpackChunkcompositor_live=self.webpackChunkcompositor_live||[]).push([[7508],{5237:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>d,toc:()=>l});var r=t(5893),i=t(1151);const s={description:"API routes to configure the compositor."},o="Routes",d={id:"api/routes",title:"Routes",description:"API routes to configure the compositor.",source:"@site/pages/api/routes.md",sourceDirName:"api",slug:"/api/routes",permalink:"/docs/api/routes",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{description:"API routes to configure the compositor."},sidebar:"sidebar",previous:{title:"API Reference",permalink:"/docs/category/api-reference"},next:{title:"InputStream",permalink:"/docs/api/components/InputStream"}},c={},l=[{value:"Endpoint <code>POST /--/api</code>",id:"endpoint-post---api",level:2},{value:"Start",id:"start",level:3},{value:"Update output",id:"update-output",level:3},{value:"Register input stream",id:"register-input-stream",level:3},{value:"Register output stream",id:"register-output-stream",level:3},{value:"Register renderer",id:"register-renderer",level:3},{value:"Unregister request",id:"unregister-request",level:3},{value:"Endpoint <code>GET /status</code>",id:"endpoint-get-status",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"routes",children:"Routes"}),"\n",(0,r.jsxs)(n.p,{children:["API is served by default on the port 8081. Different port can be configured using ",(0,r.jsx)(n.a,{href:"../deployment/configuration#live_compositor_api_port",children:(0,r.jsx)(n.code,{children:"LIVE_COMPOSITOR_API_PORT"})})," environment variable."]}),"\n",(0,r.jsxs)(n.h2,{id:"endpoint-post---api",children:["Endpoint ",(0,r.jsx)(n.code,{children:"POST /--/api"})]}),"\n",(0,r.jsx)(n.p,{children:"Main endpoint for configuring the compositor server."}),"\n",(0,r.jsx)(n.h3,{id:"start",children:"Start"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'type Start = {\n  type: "start";\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Starts the processing pipeline. If outputs are registered and defined in the scene then the compositor will start to send the RTP stream."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"update-output",children:"Update output"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'type UpdateOutput = {\n  type: "update_output";\n  output_id: string;\n  video?: Component;\n  audio?: {\n    inputs: AudioInput[];\n  };\n  schedule_time_ms?: number;\n}\n\ntype AudioInput = {\n  input_id: InputId;\n  volume?: number;\n}\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"output_id"})," - Id of an already registered output stream. See ",(0,r.jsx)(n.a,{href:"./routes#register-output-stream",children:(0,r.jsx)(n.code,{children:"RegisterOutputStream"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"video"})," - Root of a component tree/scene that should be rendered for the output. ",(0,r.jsx)(n.a,{href:"../concept/component",children:"Learn more"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"audio"})," - Parameters for mixing input audio streams."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"audio.inputs[].input_id"})," - Input id."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"audio.inputs[].volume"})," - (",(0,r.jsxs)(n.strong,{children:["default=",(0,r.jsx)(n.code,{children:"1.0"})]}),") Float in ",(0,r.jsx)(n.code,{children:"[0, 1]"})," range representing volume."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"schedule_time_ms"})," - Time in milliseconds when this request should be applied. Value ",(0,r.jsx)(n.code,{children:"0"})," represents time of ",(0,r.jsx)(n.a,{href:"#start",children:"the start request"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"register-input-stream",children:"Register input stream"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'type RegisterInputStream = {\n  type: "register";\n  entity_type: "rtp_input_stream" | "mp4";\n  ... // input specific options\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"See inputs documentation to learn more."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"./inputs/rtp",children:"RTP"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"./inputs/mp4",children:"MP4"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"register-output-stream",children:"Register output stream"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'type RegisterOutputStream = {\n  type: "register";\n  entity_type: "output_stream";\n  output_id: string;\n  transport_protocol?: "udp" | "tcp_server";\n  port: u16;\n  ip?: string;\n  video?: Video;\n  audio?: Audio;\n}\n\ntype Video = {\n  resolution: { width: number, height: number },\n  encoder_preset?: VideoEncoderPreset,\n  initial: Component,\n}\n\ntype Audio = {\n  channels: "stereo" | "mono";\n  forward_error_correction?: boolean;\n  encoder_preset?: AudioEncoderPreset;\n  initial: {\n    inputs: AudioInput[];\n  };\n}\n\ntype AudioInput = {\n  input_id: string;\n  volume?: number;\n}\n\ntype VideoEncoderPreset =\n  | "ultrafast"\n  | "superfast"\n  | "veryfast"\n  | "faster"\n  | "fast"\n  | "medium"\n  | "slow"\n  | "slower"\n  | "veryslow"\n  | "placebo"\n\ntype AudioEncoderPreset =\n  | "quality"\n  | "voip"\n  | "lowest_latency"\n'})}),"\n",(0,r.jsx)(n.p,{children:"Register a new RTP output stream."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"output_id"})," - An identifier for the output stream. It can be used in the ",(0,r.jsx)(n.code,{children:"UpdateOutput"})," request to define what to render for the output stream."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"transport_protocol"})," -  (",(0,r.jsxs)(n.strong,{children:["default=",(0,r.jsx)(n.code,{children:'"udp"'})]}),") Transport layer protocol that will be used to send RTP packets."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"udp"})," - UDP protocol."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"tcp_server"})," - TCP protocol where LiveCompositor is the server side of the connection."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"port"})," - Depends on the value of the ",(0,r.jsx)(n.code,{children:"transport_protocol"})," field:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"udp"})," - An UDP port number that RTP packets will be sent to."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"tcp_server"})," - A local TCP port number or a port range that LiveCompositor will listen for incoming connections."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ip"})," - Only valid if ",(0,r.jsx)(n.code,{children:'transport_protocol="udp"'}),". IP address where RTP packets should be sent to."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"video.resolution"})," - Output resolution in pixels."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"video.encoder_preset"})," - (",(0,r.jsxs)(n.strong,{children:["default=",(0,r.jsx)(n.code,{children:'"fast"'})]}),") Preset for an encoder. See ",(0,r.jsx)(n.code,{children:"FFmpeg"})," ",(0,r.jsx)(n.a,{href:"https://trac.ffmpeg.org/wiki/Encode/H.264#Preset",children:"docs"})," to learn more."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"video.initial"})," - Root of a component tree/scene that should be rendered for the output. Use ",(0,r.jsxs)(n.a,{href:"#update-output",children:[(0,r.jsx)(n.code,{children:"update_output"})," request"]})," to update this value after registration. ",(0,r.jsx)(n.a,{href:"../concept/component",children:"Learn more"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"audio.channels"})," - Channel configuration for output audio."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"audio.forward_error_correction"})," - (",(0,r.jsxs)(n.strong,{children:["default=",(0,r.jsx)(n.code,{children:"false"})]}),") Specifies whether the stream use forward error correction. It's specific for Opus codec. For more information, check out ",(0,r.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc6716#section-2.1.7",children:"RFC"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"audio.encoder_preset"})," - (",(0,r.jsxs)(n.strong,{children:["default=",(0,r.jsx)(n.code,{children:'"voip"'})]}),") Preset for an encoder."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"quality"})," - Best for broadcast/high-fidelity application where the decoded audio should be as close as possible to the input."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"voip"})," -  Best for most VoIP/videoconference applications where listening quality and intelligibility matter most."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"lowest_latency"})," - Only use when lowest-achievable latency is what matters most."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"audio.initial"})," - Initial configuration for audio mixer for this output. Use ",(0,r.jsxs)(n.a,{href:"#update-output",children:[(0,r.jsx)(n.code,{children:"update_output"})," request"]})," to update this value after registration."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"audio.initial.inputs[].input_id"})," - Input id."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"audio.initial.inputs[].volume"})," - (",(0,r.jsxs)(n.strong,{children:["default=",(0,r.jsx)(n.code,{children:"1.0"})]}),") Float in ",(0,r.jsx)(n.code,{children:"[0, 1]"})," range representing volume."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"register-renderer",children:"Register renderer"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'type RegisterRenderer = {\n  type: "register";\n  entity_type: "shader" | "web_renderer" | "image";\n  ... // renderer specific options\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"See renderers documentation to learn more."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"./renderers/image",children:"Image"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"./renderers/shader",children:"Shader"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"./renderers/web",children:"WebRenderer"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"unregister-request",children:"Unregister request"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'type Unregister =\n  | {\n    type: "unregister";\n    entity_type: "input_stream";\n    input_id: string;\n    schedule_time_ms: number;\n  }\n  | {\n    type: "unregister";\n    entity_type: "output_stream";\n    output_id: string;\n    schedule_time_ms: number;\n  }\n  | { type: "unregister"; entity_type: "shader"; shader_id: string }\n  | { type: "unregister"; entity_type: "image"; image_id: string }\n  | { type: "unregister"; entity_type: "web_renderer"; instance_id: string }\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Removes entities previously registered with ",(0,r.jsx)(n.a,{href:"#register-input-stream",children:"register input"}),", ",(0,r.jsx)(n.a,{href:"#register-output-stream",children:"register output"})," or ",(0,r.jsx)(n.a,{href:"#register-renderer",children:"register renderer"})," requests."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"schedule_time_ms"})," - Time in milliseconds when this request should be applied. Value ",(0,r.jsx)(n.code,{children:"0"})," represents time of ",(0,r.jsx)(n.a,{href:"#start",children:"the start request"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"endpoint-get-status",children:["Endpoint ",(0,r.jsx)(n.code,{children:"GET /status"})]}),"\n",(0,r.jsxs)(n.p,{children:["Status/health check endpoint. Returns ",(0,r.jsx)(n.code,{children:"200 OK"}),"."]})]})}function u(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>d,a:()=>o});var r=t(7294);const i={},s=r.createContext(i);function o(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);